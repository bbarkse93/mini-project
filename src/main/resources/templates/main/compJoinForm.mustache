<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Website</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/css/style.css">
</head>
<style>
</style>
<div class="wrap">
    <div class="login">
        <h2> 기업 회원가입</h2>
        <form action="/compJoin" method="post" enctype="application/x-www-form-urlencoded">
            <div class="login-id">
                <label for="username">
                    <h4>아이디</h4>
                </label>
                <input type="text" name="username" id="username" placeholder="아이디를 입력해주세요">
                <button type="button" class="btn btn-warning" onclick="check()">중복체크</button>
            </div>
            <div class="login-pw">
                <label for="password">
                    <h4>비밀번호</h4>
                </label>
                <input type="password" name="password" id="password" placeholder="비밀번호를 입력해주세요">
            </div>
            <hr style="border-color: #000000; margin: 20px auto; width: 100%;">
            <div class="join-name">
                <label for="name">
                    <h4>회사명</h4>
                </label>
                <input type="text" name="name" id="name" placeholder="회사명을 입력해주세요">
            </div>
            <div class="join-date">
                <label for="registNumber">
                    <h4>사업자 등록번호</h4>
                </label>
                <input type="text" name="registNumber" id="registNumber" placeholder="사업자등록번호를 입력해주세요">
            </div>
            <div class="join-phone">
                <label for="telNumber">
                    <h4>전화번호</h4>
                </label>
                <input type="tel" name="telNumber" id="telNumber" placeholder="전화번호를 입력해주세요">
            </div>
            <div class="join-email">
                <label for="email">
                    <h4>Email</h4>
                </label>
                <input type="email" name="email" id="email" placeholder="이메일을 입력해주세요">
            </div>
            <div>
                <input type="hidden" name="distinguish" value="false">
            </div>
            <div class="submit submit ">
                <input type="submit" value="submit">
            </div>
        </form>
    </div>
</div>

<script>
    let usernameSameCheck = false;
    function usernameChange() {
        usernameSameCheck = false;
    }
    function valid() {
        if (usernameSameCheck) {
            return true;
        } else {
            alert("유저네임 중복체크를 해주세요")
            return false;
        }
    }

    async function check() {
        let username = document.querySelector("#username").value;
        let response = await fetch(`/api/check?username=${username}`);
        let responseBody = await response.json();


        if (responseBody.sucuess) {
            alert(responseBody.data)
            usernameSameCheck = true;
            // 중복 체크 성공 -> 서브밋 버튼 활성화
            document.querySelector('input[type="submit"]').disabled = false;
        } else {
            alert(responseBody.data);
            usernameSameCheck = false;
            // 중복 체크 실패 -> 서브밋 버튼 비활성화
            document.querySelector('input[type="submit"]').disabled = true;
        }
    }
</script>

</body>

</html>